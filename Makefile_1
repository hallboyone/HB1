CXX := g++ # This is the main compiler                                                                                                                                               

SRCDIR := src
HDDIR  := include
LIBDIR := lib

SRCEXT := cpp
LIBEXT := so

SOURCES   := $(shell find $(SRCDIR) -type f -name *.$(SRCEXT))
TARGETS := $(patsubst %.$(SRCEXT), %.$(LIBEXT), $(addprefix $(LIBDIR)/HB1/lib, $(notdir $(SOURCES))))


#===== Flags =====
CXXFLAGS  := -Wall -fPIC -Werror -Wsign-compare -Wwrite-strings -Wtype-limits -std=c++11 -O3
LDFLAGS := -shared
INC     := -I $(HDDIR)

libs: $(TARGETS)

$(LIBDIR)/HB1/lib%.$(LIBEXT): $(SRCDIR)/HB1/%.$(SRCEXT)
	@mkdir -p $(LIBDIR)/HB1
	@echo "$(CXX) $(CXXFLAGS) $(LDFLAGS) $(INC) -o $@ $<"; $(CXX) $(CXXFLAGS) $(LDFLAGS) $(INC) -o $@ $<

.PHONEY: libs
